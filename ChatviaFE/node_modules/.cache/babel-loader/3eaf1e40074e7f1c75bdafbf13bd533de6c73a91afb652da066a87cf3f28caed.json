{"ast":null,"code":"// src/redux/contact/saga.js\n\nimport { call, put, takeLatest, all, take } from \"redux-saga/effects\";\n// import { fetchContactSuccess, fetchContactFailure } from '../contact/action';\nimport { fetchContactSuccess, fetchContactFailure, fetchContactRequest, acceptContactSuccess } from \"../contact/action\";\n// import { FETCH_CONTACT_REQUEST } from './actionTypes';\nimport { ACCEPT_CONTACT_REQUEST, CANCEL_CONTACT_REQUEST, DELETE_CONTACT_REQUEST, FETCH_CONTACT_REQUEST, FETCH_CONTACT_SUCCESS, INVITE_CONTACT_REQUEST, REFUSE_CONTACT_REQUEST } from \"../actionTypes\";\nimport { Alert } from \"reactstrap\";\nconst getCookie = name => {\n  var _document$cookie$spli;\n  const cookieValue = (_document$cookie$spli = document.cookie.split(\"; \").find(row => row.startsWith(name + \"=\"))) === null || _document$cookie$spli === void 0 ? void 0 : _document$cookie$spli.split(\"=\")[1];\n  return cookieValue ? decodeURIComponent(cookieValue) : null;\n};\n// Hàm gọi API lấy danh sách contact\nfunction* fetchContacts() {\n  try {\n    const response = yield call(fetch, 'https://localhost:7098/api/Contact/', {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: `Bearer ${getCookie(\"token\")}`\n      }\n    });\n    const data = yield response.json();\n    yield put(fetchContactSuccess(data));\n  } catch (e) {\n    yield put(fetchContactFailure(e.message));\n  }\n}\nfunction* inviteContacts({\n  payload: {\n    userName\n  }\n}) {\n  try {\n    const response = yield call(fetch, 'https://localhost:7098/api/Contact/invite', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: `Bearer ${getCookie(\"token\")}`,\n        'userName': userName\n      },\n      body: JSON.stringify()\n    });\n    const data = yield response.json();\n    yield alert(data.message);\n    // yield put(fetchContactSuccess(data));\n    yield put(fetchContactRequest());\n  } catch (e) {\n    // yield put(fetchContactFailure(e.message));\n    yield alert(e.message);\n  }\n}\nfunction* acceptContacts({\n  payload: {\n    userId\n  }\n}) {\n  yield console.log(userId, \"saga\");\n  try {\n    const response = yield call(fetch, 'https://localhost:7098/api/Contact/accept', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: `Bearer ${getCookie(\"token\")}`,\n        'userId': userId\n      },\n      body: JSON.stringify()\n    });\n    const data = yield response.json();\n    yield put(fetchContactRequest());\n    yield take(FETCH_CONTACT_SUCCESS);\n    // yield alert(data.message);\n    yield console.log(data.message);\n  } catch (e) {\n    // yield put(fetchContactFailure(e.message));\n    yield alert(e.message);\n  }\n}\nfunction* cancelContacts({\n  payload: {\n    userId\n  }\n}) {\n  try {\n    const response = yield call(fetch, 'https://localhost:7098/api/Contact/cancel', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: `Bearer ${getCookie(\"token\")}`,\n        'userId': userId\n      },\n      body: JSON.stringify()\n    });\n    const data = yield response.json();\n    yield put(fetchContactRequest());\n    yield take(FETCH_CONTACT_SUCCESS);\n    yield console.log(data.message);\n  } catch (e) {\n    // yield put(fetchContactFailure(e.message));\n    yield console.log(e.message);\n  }\n}\nfunction* refuseContacts({\n  payload: {\n    userId\n  }\n}) {\n  try {\n    const response = yield call(fetch, 'https://localhost:7098/api/Contact/refuse', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: `Bearer ${getCookie(\"token\")}`,\n        'userId': userId\n      },\n      body: JSON.stringify()\n    });\n    const data = yield response.json();\n    yield put(fetchContactRequest());\n    yield take(FETCH_CONTACT_SUCCESS);\n    yield console.log(data.message);\n  } catch (e) {\n    // yield put(fetchContactFailure(e.message));\n    yield console.log(e.message);\n  }\n}\nfunction* deleteContacts({\n  payload: {\n    userId\n  }\n}) {\n  try {\n    const response = yield call(fetch, 'https://localhost:7098/api/Contact/delete', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: `Bearer ${getCookie(\"token\")}`,\n        'userId': userId\n      },\n      body: JSON.stringify()\n    });\n    const data = yield response.json();\n    yield put(fetchContactRequest());\n    yield take(FETCH_CONTACT_SUCCESS);\n    yield console.log(data.message);\n  } catch (e) {\n    // yield put(fetchContactFailure(e.message));\n    yield console.log(e.message);\n  }\n}\n\n// Watcher Saga\nexport function* watchFetchContacts() {\n  yield all([takeLatest(FETCH_CONTACT_REQUEST, fetchContacts), takeLatest(INVITE_CONTACT_REQUEST, inviteContacts), takeLatest(ACCEPT_CONTACT_REQUEST, acceptContacts), takeLatest(CANCEL_CONTACT_REQUEST, cancelContacts), takeLatest(REFUSE_CONTACT_REQUEST, refuseContacts), takeLatest(DELETE_CONTACT_REQUEST, deleteContacts)]);\n}","map":{"version":3,"names":["call","put","takeLatest","all","take","fetchContactSuccess","fetchContactFailure","fetchContactRequest","acceptContactSuccess","ACCEPT_CONTACT_REQUEST","CANCEL_CONTACT_REQUEST","DELETE_CONTACT_REQUEST","FETCH_CONTACT_REQUEST","FETCH_CONTACT_SUCCESS","INVITE_CONTACT_REQUEST","REFUSE_CONTACT_REQUEST","Alert","getCookie","name","_document$cookie$spli","cookieValue","document","cookie","split","find","row","startsWith","decodeURIComponent","fetchContacts","response","fetch","method","headers","Authorization","data","json","e","message","inviteContacts","payload","userName","body","JSON","stringify","alert","acceptContacts","userId","console","log","cancelContacts","refuseContacts","deleteContacts","watchFetchContacts"],"sources":["C:/Users/Administrator/Desktop/ChatBF/ChatviaFE/src/redux/contact/saga.js"],"sourcesContent":["// src/redux/contact/saga.js\r\n\r\nimport { call, put, takeLatest, all, take } from \"redux-saga/effects\";\r\n// import { fetchContactSuccess, fetchContactFailure } from '../contact/action';\r\nimport { fetchContactSuccess, fetchContactFailure, fetchContactRequest, acceptContactSuccess } from \"../contact/action\";\r\n// import { FETCH_CONTACT_REQUEST } from './actionTypes';\r\nimport { ACCEPT_CONTACT_REQUEST, CANCEL_CONTACT_REQUEST, DELETE_CONTACT_REQUEST, FETCH_CONTACT_REQUEST, FETCH_CONTACT_SUCCESS, INVITE_CONTACT_REQUEST, REFUSE_CONTACT_REQUEST } from \"../actionTypes\";\r\nimport { Alert } from \"reactstrap\";\r\n\r\nconst getCookie = (name) => {\r\n  const cookieValue = document.cookie\r\n    .split(\"; \")\r\n    .find((row) => row.startsWith(name + \"=\"))\r\n    ?.split(\"=\")[1];\r\n\r\n  return cookieValue ? decodeURIComponent(cookieValue) : null;\r\n};\r\n// Hàm gọi API lấy danh sách contact\r\nfunction* fetchContacts() {\r\n  try {\r\n    const response = yield call(fetch, 'https://localhost:7098/api/Contact/', {\r\n        method: 'GET',\r\n        headers: {\r\n            'Content-Type': 'application/json',\r\n            Authorization: `Bearer ${getCookie(\"token\")}`,\r\n        },\r\n    });\r\n    const data = yield response.json();\r\n    yield put(fetchContactSuccess(data));\r\n  }catch(e){\r\n    yield put(fetchContactFailure(e.message));\r\n  }\r\n}\r\n\r\n\r\n\r\nfunction* inviteContacts({payload: {userName}}) {\r\n  try {\r\n    const response = yield call(fetch, 'https://localhost:7098/api/Contact/invite', {\r\n        method: 'POST',\r\n        headers: {\r\n            'Content-Type': 'application/json',\r\n            Authorization: `Bearer ${getCookie(\"token\")}`,\r\n            'userName': userName\r\n        },\r\n        body: JSON.stringify(),\r\n    });\r\n    const data = yield response.json();\r\n    yield alert(data.message);\r\n    // yield put(fetchContactSuccess(data));\r\n    yield put(fetchContactRequest());\r\n\r\n  }catch(e){\r\n    // yield put(fetchContactFailure(e.message));\r\n    yield alert(e.message);\r\n  }\r\n}\r\n\r\n\r\nfunction* acceptContacts({payload: {userId}}) {\r\n\r\n\r\n yield console.log(userId,\"saga\")\r\n  try {\r\n    const response = yield call(fetch, 'https://localhost:7098/api/Contact/accept', {\r\n        method: 'POST',\r\n        headers: {\r\n            'Content-Type': 'application/json',\r\n            Authorization: `Bearer ${getCookie(\"token\")}`,\r\n            'userId': userId\r\n        },\r\n        body: JSON.stringify(),\r\n    });\r\n\r\n\r\n    const data = yield response.json();\r\n    yield put(fetchContactRequest());\r\n    yield take(FETCH_CONTACT_SUCCESS);\r\n    // yield alert(data.message);\r\n    yield console.log(data.message);\r\n  }catch(e){\r\n    // yield put(fetchContactFailure(e.message));\r\n    yield alert(e.message);\r\n  }\r\n}\r\n\r\nfunction* cancelContacts({payload: {userId}}) {\r\n   try {\r\n     const response = yield call(fetch, 'https://localhost:7098/api/Contact/cancel', {\r\n         method: 'POST',\r\n         headers: {\r\n             'Content-Type': 'application/json',\r\n             Authorization: `Bearer ${getCookie(\"token\")}`,\r\n             'userId': userId\r\n         },\r\n         body: JSON.stringify(),\r\n     });\r\n     \r\n \r\n     const data = yield response.json();\r\n     yield put(fetchContactRequest());\r\n     yield take(FETCH_CONTACT_SUCCESS);\r\n     yield console.log(data.message);\r\n   }catch(e){\r\n     // yield put(fetchContactFailure(e.message));\r\n     yield console.log(e.message)\r\n   }\r\n }\r\n\r\n\r\n function* refuseContacts({payload: {userId}}) {\r\n  try {\r\n    const response = yield call(fetch, 'https://localhost:7098/api/Contact/refuse', {\r\n        method: 'POST',\r\n        headers: {\r\n            'Content-Type': 'application/json',\r\n            Authorization: `Bearer ${getCookie(\"token\")}`,\r\n            'userId': userId\r\n        },\r\n        body: JSON.stringify(),\r\n    });\r\n    \r\n\r\n    const data = yield response.json();\r\n    yield put(fetchContactRequest());\r\n    yield take(FETCH_CONTACT_SUCCESS);\r\n    yield console.log(data.message);\r\n  }catch(e){\r\n    // yield put(fetchContactFailure(e.message));\r\n    yield console.log(e.message)\r\n  }\r\n}\r\n\r\nfunction* deleteContacts({payload: {userId}}) {\r\n  try {\r\n    const response = yield call(fetch, 'https://localhost:7098/api/Contact/delete', {\r\n        method: 'POST',\r\n        headers: {\r\n            'Content-Type': 'application/json',\r\n            Authorization: `Bearer ${getCookie(\"token\")}`,\r\n            'userId': userId\r\n        },\r\n        body: JSON.stringify(),\r\n    });\r\n    \r\n\r\n    const data = yield response.json();\r\n    yield put(fetchContactRequest());\r\n    yield take(FETCH_CONTACT_SUCCESS);\r\n    yield console.log(data.message);\r\n  }catch(e){\r\n    // yield put(fetchContactFailure(e.message));\r\n    yield console.log(e.message)\r\n  }\r\n}\r\n\r\n\r\n\r\n// Watcher Saga\r\nexport function* watchFetchContacts() {\r\n  yield all([\r\n   takeLatest(FETCH_CONTACT_REQUEST, fetchContacts),\r\n  takeLatest(INVITE_CONTACT_REQUEST, inviteContacts),\r\n  takeLatest(ACCEPT_CONTACT_REQUEST, acceptContacts),\r\n  takeLatest(CANCEL_CONTACT_REQUEST, cancelContacts),\r\n  takeLatest(REFUSE_CONTACT_REQUEST, refuseContacts),\r\n  takeLatest(DELETE_CONTACT_REQUEST, deleteContacts)\r\n  ])\r\n}\r\n\r\n\r\n\r\n"],"mappings":"AAAA;;AAEA,SAASA,IAAI,EAAEC,GAAG,EAAEC,UAAU,EAAEC,GAAG,EAAEC,IAAI,QAAQ,oBAAoB;AACrE;AACA,SAASC,mBAAmB,EAAEC,mBAAmB,EAAEC,mBAAmB,EAAEC,oBAAoB,QAAQ,mBAAmB;AACvH;AACA,SAASC,sBAAsB,EAAEC,sBAAsB,EAAEC,sBAAsB,EAAEC,qBAAqB,EAAEC,qBAAqB,EAAEC,sBAAsB,EAAEC,sBAAsB,QAAQ,gBAAgB;AACrM,SAASC,KAAK,QAAQ,YAAY;AAElC,MAAMC,SAAS,GAAIC,IAAI,IAAK;EAAA,IAAAC,qBAAA;EAC1B,MAAMC,WAAW,IAAAD,qBAAA,GAAGE,QAAQ,CAACC,MAAM,CAChCC,KAAK,CAAC,IAAI,CAAC,CACXC,IAAI,CAAEC,GAAG,IAAKA,GAAG,CAACC,UAAU,CAACR,IAAI,GAAG,GAAG,CAAC,CAAC,cAAAC,qBAAA,uBAFxBA,qBAAA,CAGhBI,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;EAEjB,OAAOH,WAAW,GAAGO,kBAAkB,CAACP,WAAW,CAAC,GAAG,IAAI;AAC7D,CAAC;AACD;AACA,UAAUQ,aAAaA,CAAA,EAAG;EACxB,IAAI;IACF,MAAMC,QAAQ,GAAG,MAAM7B,IAAI,CAAC8B,KAAK,EAAE,qCAAqC,EAAE;MACtEC,MAAM,EAAE,KAAK;MACbC,OAAO,EAAE;QACL,cAAc,EAAE,kBAAkB;QAClCC,aAAa,EAAG,UAAShB,SAAS,CAAC,OAAO,CAAE;MAChD;IACJ,CAAC,CAAC;IACF,MAAMiB,IAAI,GAAG,MAAML,QAAQ,CAACM,IAAI,CAAC,CAAC;IAClC,MAAMlC,GAAG,CAACI,mBAAmB,CAAC6B,IAAI,CAAC,CAAC;EACtC,CAAC,QAAME,CAAC,EAAC;IACP,MAAMnC,GAAG,CAACK,mBAAmB,CAAC8B,CAAC,CAACC,OAAO,CAAC,CAAC;EAC3C;AACF;AAIA,UAAUC,cAAcA,CAAC;EAACC,OAAO,EAAE;IAACC;EAAQ;AAAC,CAAC,EAAE;EAC9C,IAAI;IACF,MAAMX,QAAQ,GAAG,MAAM7B,IAAI,CAAC8B,KAAK,EAAE,2CAA2C,EAAE;MAC5EC,MAAM,EAAE,MAAM;MACdC,OAAO,EAAE;QACL,cAAc,EAAE,kBAAkB;QAClCC,aAAa,EAAG,UAAShB,SAAS,CAAC,OAAO,CAAE,EAAC;QAC7C,UAAU,EAAEuB;MAChB,CAAC;MACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;IACzB,CAAC,CAAC;IACF,MAAMT,IAAI,GAAG,MAAML,QAAQ,CAACM,IAAI,CAAC,CAAC;IAClC,MAAMS,KAAK,CAACV,IAAI,CAACG,OAAO,CAAC;IACzB;IACA,MAAMpC,GAAG,CAACM,mBAAmB,CAAC,CAAC,CAAC;EAElC,CAAC,QAAM6B,CAAC,EAAC;IACP;IACA,MAAMQ,KAAK,CAACR,CAAC,CAACC,OAAO,CAAC;EACxB;AACF;AAGA,UAAUQ,cAAcA,CAAC;EAACN,OAAO,EAAE;IAACO;EAAM;AAAC,CAAC,EAAE;EAG7C,MAAMC,OAAO,CAACC,GAAG,CAACF,MAAM,EAAC,MAAM,CAAC;EAC/B,IAAI;IACF,MAAMjB,QAAQ,GAAG,MAAM7B,IAAI,CAAC8B,KAAK,EAAE,2CAA2C,EAAE;MAC5EC,MAAM,EAAE,MAAM;MACdC,OAAO,EAAE;QACL,cAAc,EAAE,kBAAkB;QAClCC,aAAa,EAAG,UAAShB,SAAS,CAAC,OAAO,CAAE,EAAC;QAC7C,QAAQ,EAAE6B;MACd,CAAC;MACDL,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;IACzB,CAAC,CAAC;IAGF,MAAMT,IAAI,GAAG,MAAML,QAAQ,CAACM,IAAI,CAAC,CAAC;IAClC,MAAMlC,GAAG,CAACM,mBAAmB,CAAC,CAAC,CAAC;IAChC,MAAMH,IAAI,CAACS,qBAAqB,CAAC;IACjC;IACA,MAAMkC,OAAO,CAACC,GAAG,CAACd,IAAI,CAACG,OAAO,CAAC;EACjC,CAAC,QAAMD,CAAC,EAAC;IACP;IACA,MAAMQ,KAAK,CAACR,CAAC,CAACC,OAAO,CAAC;EACxB;AACF;AAEA,UAAUY,cAAcA,CAAC;EAACV,OAAO,EAAE;IAACO;EAAM;AAAC,CAAC,EAAE;EAC3C,IAAI;IACF,MAAMjB,QAAQ,GAAG,MAAM7B,IAAI,CAAC8B,KAAK,EAAE,2CAA2C,EAAE;MAC5EC,MAAM,EAAE,MAAM;MACdC,OAAO,EAAE;QACL,cAAc,EAAE,kBAAkB;QAClCC,aAAa,EAAG,UAAShB,SAAS,CAAC,OAAO,CAAE,EAAC;QAC7C,QAAQ,EAAE6B;MACd,CAAC;MACDL,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;IACzB,CAAC,CAAC;IAGF,MAAMT,IAAI,GAAG,MAAML,QAAQ,CAACM,IAAI,CAAC,CAAC;IAClC,MAAMlC,GAAG,CAACM,mBAAmB,CAAC,CAAC,CAAC;IAChC,MAAMH,IAAI,CAACS,qBAAqB,CAAC;IACjC,MAAMkC,OAAO,CAACC,GAAG,CAACd,IAAI,CAACG,OAAO,CAAC;EACjC,CAAC,QAAMD,CAAC,EAAC;IACP;IACA,MAAMW,OAAO,CAACC,GAAG,CAACZ,CAAC,CAACC,OAAO,CAAC;EAC9B;AACF;AAGA,UAAUa,cAAcA,CAAC;EAACX,OAAO,EAAE;IAACO;EAAM;AAAC,CAAC,EAAE;EAC7C,IAAI;IACF,MAAMjB,QAAQ,GAAG,MAAM7B,IAAI,CAAC8B,KAAK,EAAE,2CAA2C,EAAE;MAC5EC,MAAM,EAAE,MAAM;MACdC,OAAO,EAAE;QACL,cAAc,EAAE,kBAAkB;QAClCC,aAAa,EAAG,UAAShB,SAAS,CAAC,OAAO,CAAE,EAAC;QAC7C,QAAQ,EAAE6B;MACd,CAAC;MACDL,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;IACzB,CAAC,CAAC;IAGF,MAAMT,IAAI,GAAG,MAAML,QAAQ,CAACM,IAAI,CAAC,CAAC;IAClC,MAAMlC,GAAG,CAACM,mBAAmB,CAAC,CAAC,CAAC;IAChC,MAAMH,IAAI,CAACS,qBAAqB,CAAC;IACjC,MAAMkC,OAAO,CAACC,GAAG,CAACd,IAAI,CAACG,OAAO,CAAC;EACjC,CAAC,QAAMD,CAAC,EAAC;IACP;IACA,MAAMW,OAAO,CAACC,GAAG,CAACZ,CAAC,CAACC,OAAO,CAAC;EAC9B;AACF;AAEA,UAAUc,cAAcA,CAAC;EAACZ,OAAO,EAAE;IAACO;EAAM;AAAC,CAAC,EAAE;EAC5C,IAAI;IACF,MAAMjB,QAAQ,GAAG,MAAM7B,IAAI,CAAC8B,KAAK,EAAE,2CAA2C,EAAE;MAC5EC,MAAM,EAAE,MAAM;MACdC,OAAO,EAAE;QACL,cAAc,EAAE,kBAAkB;QAClCC,aAAa,EAAG,UAAShB,SAAS,CAAC,OAAO,CAAE,EAAC;QAC7C,QAAQ,EAAE6B;MACd,CAAC;MACDL,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;IACzB,CAAC,CAAC;IAGF,MAAMT,IAAI,GAAG,MAAML,QAAQ,CAACM,IAAI,CAAC,CAAC;IAClC,MAAMlC,GAAG,CAACM,mBAAmB,CAAC,CAAC,CAAC;IAChC,MAAMH,IAAI,CAACS,qBAAqB,CAAC;IACjC,MAAMkC,OAAO,CAACC,GAAG,CAACd,IAAI,CAACG,OAAO,CAAC;EACjC,CAAC,QAAMD,CAAC,EAAC;IACP;IACA,MAAMW,OAAO,CAACC,GAAG,CAACZ,CAAC,CAACC,OAAO,CAAC;EAC9B;AACF;;AAIA;AACA,OAAO,UAAUe,kBAAkBA,CAAA,EAAG;EACpC,MAAMjD,GAAG,CAAC,CACTD,UAAU,CAACU,qBAAqB,EAAEgB,aAAa,CAAC,EACjD1B,UAAU,CAACY,sBAAsB,EAAEwB,cAAc,CAAC,EAClDpC,UAAU,CAACO,sBAAsB,EAAEoC,cAAc,CAAC,EAClD3C,UAAU,CAACQ,sBAAsB,EAAEuC,cAAc,CAAC,EAClD/C,UAAU,CAACa,sBAAsB,EAAEmC,cAAc,CAAC,EAClDhD,UAAU,CAACS,sBAAsB,EAAEwC,cAAc,CAAC,CACjD,CAAC;AACJ"},"metadata":{},"sourceType":"module","externalDependencies":[]}